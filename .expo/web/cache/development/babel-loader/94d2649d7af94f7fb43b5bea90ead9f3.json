{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport React, { useEffect, useState } from 'react';\nimport AppRegistry from \"react-native-web/dist/exports/AppRegistry\";\nimport ChildrenWrapper from \"./ChildrenWrapper\";\nimport wrapRootComponent from \"./wrapRootComponent\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\n\nvar siblingWrapper = function siblingWrapper(sibling) {\n  return sibling;\n};\n\nfunction renderSibling(sibling) {\n  return siblingWrapper(sibling);\n}\n\nif (!global.__rootSiblingsInjected && !global.__rootSiblingsDisabled) {\n  AppRegistry.setWrapperComponentProvider(function () {\n    return Root;\n  });\n  global.__rootSiblingsInjected = true;\n}\n\nexport function setSiblingWrapper(wrapper) {\n  siblingWrapper = wrapper;\n}\n\nvar _wrapRootComponent = wrapRootComponent(ChildrenWrapper, renderSibling),\n    Root = _wrapRootComponent.Root,\n    defaultManager = _wrapRootComponent.manager;\n\nvar uuid = 0;\nvar managerStack = [defaultManager];\nvar inactiveManagers = new Set();\n\nfunction getActiveManager() {\n  for (var i = managerStack.length - 1; i >= 0; i--) {\n    var manager = managerStack[i];\n\n    if (!inactiveManagers.has(manager)) {\n      return manager;\n    }\n  }\n\n  return defaultManager;\n}\n\nvar RootSiblingsManager = function () {\n  function RootSiblingsManager(element, callback) {\n    _classCallCheck(this, RootSiblingsManager);\n\n    this.id = \"root-sibling-\" + (uuid + 1);\n    this.manager = getActiveManager();\n    this.manager.update(this.id, element, callback);\n    uuid++;\n  }\n\n  _createClass(RootSiblingsManager, [{\n    key: \"update\",\n    value: function update(element, callback) {\n      this.manager.update(this.id, element, callback);\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy(callback) {\n      this.manager.destroy(this.id, callback);\n    }\n  }]);\n\n  return RootSiblingsManager;\n}();\n\nexport { RootSiblingsManager as default };\nexport function RootSiblingParent(props) {\n  var inactive = props.inactive;\n\n  var _useState = useState(function () {\n    var _wrapRootComponent2 = wrapRootComponent(ChildrenWrapper, renderSibling),\n        parentRoot = _wrapRootComponent2.Root,\n        parentManager = _wrapRootComponent2.manager;\n\n    managerStack.push(parentManager);\n\n    if (inactive) {\n      inactiveManagers.add(parentManager);\n    }\n\n    return {\n      Root: parentRoot,\n      manager: parentManager\n    };\n  }),\n      _useState2 = _slicedToArray(_useState, 1),\n      sibling = _useState2[0];\n\n  useEffect(function () {\n    return function () {\n      if (sibling) {\n        var index = managerStack.indexOf(sibling.manager);\n\n        if (index > 0) {\n          managerStack.splice(index, 1);\n        }\n      }\n    };\n  }, [sibling]);\n\n  if (inactive && sibling && !inactiveManagers.has(sibling.manager)) {\n    inactiveManagers.add(sibling.manager);\n  } else if (!inactive && sibling && inactiveManagers.has(sibling.manager)) {\n    inactiveManagers.delete(sibling.manager);\n  }\n\n  var Parent = sibling.Root;\n  return _jsx(Parent, {\n    children: props.children\n  });\n}\nexport function RootSiblingPortal(props) {\n  var _useState3 = useState(function () {\n    return new RootSiblingsManager(null);\n  }),\n      _useState4 = _slicedToArray(_useState3, 1),\n      sibling = _useState4[0];\n\n  sibling.update(props.children);\n  useEffect(function () {\n    if (sibling) {\n      return function () {\n        return sibling.destroy();\n      };\n    }\n  }, [sibling]);\n  return null;\n}","map":{"version":3,"sources":["../src/RootSiblingsManager.tsx"],"names":[],"mappings":";;;AAAA,OAAO,KAAP,IAGE,SAHF,EAIE,QAJF,QAKO,OALP;;AAQA,OAAO,eAAP;AACA,OAAO,iBAAP;;;AAEA,IAAI,cAAc,GAAsC,wBAAA,OAAO;EAAA,OAAI,OAAJ;AAAA,CAA/D;;AAEA,SAAS,aAAT,CAAuB,OAAvB,EAAyC;EACvC,OAAO,cAAc,CAAC,OAAD,CAArB;AACD;;AAED,IAAI,CAAC,MAAM,CAAC,sBAAR,IAAkC,CAAC,MAAM,CAAC,sBAA9C,EAAsE;EACpE,WAAW,CAAC,2BAAZ,CAAwC,YAAK;IAC3C,OAAO,IAAP;EACD,CAFD;EAGA,MAAM,CAAC,sBAAP,GAAgC,IAAhC;AACD;;AAED,OAAM,SAAU,iBAAV,CAA4B,OAA5B,EAAsE;EAC1E,cAAc,GAAG,OAAjB;AACD;;AAED,yBAA0C,iBAAiB,CACzD,eADyD,EAEzD,aAFyD,CAA3D;AAAA,IAAQ,IAAR,sBAAQ,IAAR;AAAA,IAAuB,cAAvB,sBAAc,OAAd;;AAIA,IAAI,IAAI,GAAW,CAAnB;AACA,IAAM,YAAY,GAAyB,CAAC,cAAD,CAA3C;AACA,IAAM,gBAAgB,GAA4B,IAAI,GAAJ,EAAlD;;AAEA,SAAS,gBAAT,GAAyB;EACvB,KAAK,IAAI,CAAC,GAAG,YAAY,CAAC,MAAb,GAAsB,CAAnC,EAAsC,CAAC,IAAI,CAA3C,EAA8C,CAAC,EAA/C,EAAmD;IACjD,IAAM,OAAO,GAAG,YAAY,CAAC,CAAD,CAA5B;;IACA,IAAI,CAAC,gBAAgB,CAAC,GAAjB,CAAqB,OAArB,CAAL,EAAoC;MAClC,OAAO,OAAP;IACD;EACF;;EAED,OAAO,cAAP;AACD;;IAEoB,mB;EAInB,6BAAY,OAAZ,EAAgC,QAAhC,EAAqD;IAAA;;IACnD,KAAK,EAAL,sBAA0B,IAAI,GAAG,CAAjC;IACA,KAAK,OAAL,GAAe,gBAAgB,EAA/B;IACA,KAAK,OAAL,CAAa,MAAb,CAAoB,KAAK,EAAzB,EAA6B,OAA7B,EAAsC,QAAtC;IACA,IAAI;EACL;;;;WAEM,gBAAO,OAAP,EAA2B,QAA3B,EAAgD;MACrD,KAAK,OAAL,CAAa,MAAb,CAAoB,KAAK,EAAzB,EAA6B,OAA7B,EAAsC,QAAtC;IACD;;;WAEM,iBAAQ,QAAR,EAA6B;MAClC,KAAK,OAAL,CAAa,OAAb,CAAqB,KAAK,EAA1B,EAA8B,QAA9B;IACD;;;;;;SAjBkB,mB;AAoBrB,OAAM,SAAU,iBAAV,CAA4B,KAA5B,EAGL;EACC,IAAQ,QAAR,GAAqB,KAArB,CAAQ,QAAR;;EACA,gBAAkB,QAAQ,CAGvB,YAAK;IACN,0BAAqD,iBAAiB,CACpE,eADoE,EAEpE,aAFoE,CAAtE;IAAA,IAAc,UAAd,uBAAQ,IAAR;IAAA,IAAmC,aAAnC,uBAA0B,OAA1B;;IAKA,YAAY,CAAC,IAAb,CAAkB,aAAlB;;IACA,IAAI,QAAJ,EAAc;MACZ,gBAAgB,CAAC,GAAjB,CAAqB,aAArB;IACD;;IAED,OAAO;MACL,IAAI,EAAE,UADD;MAEL,OAAO,EAAE;IAFJ,CAAP;EAID,CAlByB,CAA1B;EAAA;EAAA,IAAO,OAAP;;EAoBA,SAAS,CAAC,YAAK;IACb,OAAO,YAAK;MACV,IAAI,OAAJ,EAAa;QACX,IAAM,KAAK,GAAG,YAAY,CAAC,OAAb,CAAqB,OAAO,CAAC,OAA7B,CAAd;;QACA,IAAI,KAAK,GAAG,CAAZ,EAAe;UACb,YAAY,CAAC,MAAb,CAAoB,KAApB,EAA2B,CAA3B;QACD;MACF;IACF,CAPD;EAQD,CATQ,EASN,CAAC,OAAD,CATM,CAAT;;EAWA,IAAI,QAAQ,IAAI,OAAZ,IAAuB,CAAC,gBAAgB,CAAC,GAAjB,CAAqB,OAAO,CAAC,OAA7B,CAA5B,EAAmE;IACjE,gBAAgB,CAAC,GAAjB,CAAqB,OAAO,CAAC,OAA7B;EACD,CAFD,MAEO,IAAI,CAAC,QAAD,IAAa,OAAb,IAAwB,gBAAgB,CAAC,GAAjB,CAAqB,OAAO,CAAC,OAA7B,CAA5B,EAAmE;IACxE,gBAAgB,CAAC,MAAjB,CAAwB,OAAO,CAAC,OAAhC;EACD;;EAED,IAAM,MAAM,GAAG,OAAO,CAAC,IAAvB;EACA,OAAO,KAAC,MAAD;IAAA,UAAS,KAAK,CAAC;EAAf,EAAP;AACD;AAED,OAAM,SAAU,iBAAV,CAA4B,KAA5B,EAA0D;EAC9D,iBAAkB,QAAQ,CACxB;IAAA,OAAM,IAAI,mBAAJ,CAAwB,IAAxB,CAAN;EAAA,CADwB,CAA1B;EAAA;EAAA,IAAO,OAAP;;EAIA,OAAO,CAAC,MAAR,CAAe,KAAK,CAAC,QAArB;EAEA,SAAS,CAAC,YAAK;IACb,IAAI,OAAJ,EAAa;MACX,OAAO;QAAA,OAAM,OAAO,CAAC,OAAR,EAAN;MAAA,CAAP;IACD;EACF,CAJQ,EAIN,CAAC,OAAD,CAJM,CAAT;EAMA,OAAO,IAAP;AACD","sourceRoot":"","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { AppRegistry } from 'react-native';\nimport ChildrenWrapper from './ChildrenWrapper';\nimport wrapRootComponent from './wrapRootComponent';\nlet siblingWrapper = sibling => sibling;\nfunction renderSibling(sibling) {\n    return siblingWrapper(sibling);\n}\nif (!global.__rootSiblingsInjected && !global.__rootSiblingsDisabled) {\n    AppRegistry.setWrapperComponentProvider(() => {\n        return Root;\n    });\n    global.__rootSiblingsInjected = true;\n}\nexport function setSiblingWrapper(wrapper) {\n    siblingWrapper = wrapper;\n}\nconst { Root, manager: defaultManager } = wrapRootComponent(ChildrenWrapper, renderSibling);\nlet uuid = 0;\nconst managerStack = [defaultManager];\nconst inactiveManagers = new Set();\nfunction getActiveManager() {\n    for (let i = managerStack.length - 1; i >= 0; i--) {\n        const manager = managerStack[i];\n        if (!inactiveManagers.has(manager)) {\n            return manager;\n        }\n    }\n    return defaultManager;\n}\nexport default class RootSiblingsManager {\n    constructor(element, callback) {\n        this.id = `root-sibling-${uuid + 1}`;\n        this.manager = getActiveManager();\n        this.manager.update(this.id, element, callback);\n        uuid++;\n    }\n    update(element, callback) {\n        this.manager.update(this.id, element, callback);\n    }\n    destroy(callback) {\n        this.manager.destroy(this.id, callback);\n    }\n}\nexport function RootSiblingParent(props) {\n    const { inactive } = props;\n    const [sibling] = useState(() => {\n        const { Root: parentRoot, manager: parentManager } = wrapRootComponent(ChildrenWrapper, renderSibling);\n        managerStack.push(parentManager);\n        if (inactive) {\n            inactiveManagers.add(parentManager);\n        }\n        return {\n            Root: parentRoot,\n            manager: parentManager\n        };\n    });\n    useEffect(() => {\n        return () => {\n            if (sibling) {\n                const index = managerStack.indexOf(sibling.manager);\n                if (index > 0) {\n                    managerStack.splice(index, 1);\n                }\n            }\n        };\n    }, [sibling]);\n    if (inactive && sibling && !inactiveManagers.has(sibling.manager)) {\n        inactiveManagers.add(sibling.manager);\n    }\n    else if (!inactive && sibling && inactiveManagers.has(sibling.manager)) {\n        inactiveManagers.delete(sibling.manager);\n    }\n    const Parent = sibling.Root;\n    return <Parent>{props.children}</Parent>;\n}\nexport function RootSiblingPortal(props) {\n    const [sibling] = useState(() => new RootSiblingsManager(null));\n    sibling.update(props.children);\n    useEffect(() => {\n        if (sibling) {\n            return () => sibling.destroy();\n        }\n    }, [sibling]);\n    return null;\n}\n//# sourceMappingURL=RootSiblingsManager.js.map"]},"metadata":{},"sourceType":"module"}