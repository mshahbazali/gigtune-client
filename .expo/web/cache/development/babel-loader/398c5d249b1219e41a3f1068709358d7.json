{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nexport var RootControllerChanges;\n\n(function (RootControllerChanges) {\n  RootControllerChanges[RootControllerChanges[\"Insert\"] = 0] = \"Insert\";\n  RootControllerChanges[RootControllerChanges[\"Update\"] = 1] = \"Update\";\n  RootControllerChanges[RootControllerChanges[\"Remove\"] = 2] = \"Remove\";\n})(RootControllerChanges || (RootControllerChanges = {}));\n\nvar RootController = function () {\n  function RootController() {\n    _classCallCheck(this, RootController);\n\n    this.siblings = new Set();\n    this.pendingActions = [];\n    this.callback = null;\n  }\n\n  _createClass(RootController, [{\n    key: \"update\",\n    value: function update(id, element, callback) {\n      if (!this.siblings.has(id)) {\n        this.emit(id, {\n          change: RootControllerChanges.Insert,\n          element: element,\n          updateCallback: callback\n        });\n        this.siblings.add(id);\n      } else {\n        this.emit(id, {\n          change: RootControllerChanges.Update,\n          element: element,\n          updateCallback: callback\n        });\n      }\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy(id, callback) {\n      if (this.siblings.has(id)) {\n        this.emit(id, {\n          change: RootControllerChanges.Remove,\n          element: null,\n          updateCallback: callback\n        });\n        this.siblings.delete(id);\n      } else if (callback) {\n        callback();\n      }\n    }\n  }, {\n    key: \"setCallback\",\n    value: function setCallback(callback) {\n      this.callback = callback;\n      this.pendingActions.forEach(function (_ref) {\n        var id = _ref.id,\n            action = _ref.action;\n        callback(id, action);\n      });\n    }\n  }, {\n    key: \"emit\",\n    value: function emit(id, action) {\n      if (this.callback) {\n        this.callback(id, action);\n      } else {\n        this.pendingActions.push({\n          action: action,\n          id: id\n        });\n      }\n    }\n  }]);\n\n  return RootController;\n}();\n\nexport { RootController as default };","map":{"version":3,"sources":["../src/RootController.ts"],"names":[],"mappings":";;AAEA,OAAA,IAAY,qBAAZ;;AAAA,CAAA,UAAY,qBAAZ,EAAiC;EAC/B,qBAAA,CAAA,qBAAA,CAAA,QAAA,CAAA,GAAA,CAAA,CAAA,GAAA,QAAA;EACA,qBAAA,CAAA,qBAAA,CAAA,QAAA,CAAA,GAAA,CAAA,CAAA,GAAA,QAAA;EACA,qBAAA,CAAA,qBAAA,CAAA,QAAA,CAAA,GAAA,CAAA,CAAA,GAAA,QAAA;AACD,CAJD,EAAY,qBAAqB,KAArB,qBAAqB,GAAA,EAAA,CAAjC;;IAYqB,c;EAArB,0BAAA;IAAA;;IACU,KAAA,QAAA,GAAwB,IAAI,GAAJ,EAAxB;IACA,KAAA,cAAA,GAGH,EAHG;IAIA,KAAA,QAAA,GAEG,IAFH;EAqDT;;;;WAjDQ,gBAAO,EAAP,EAAmB,OAAnB,EAAuC,QAAvC,EAA4D;MACjE,IAAI,CAAC,KAAK,QAAL,CAAc,GAAd,CAAkB,EAAlB,CAAL,EAA4B;QAC1B,KAAK,IAAL,CAAU,EAAV,EAAc;UACZ,MAAM,EAAE,qBAAqB,CAAC,MADlB;UAEZ,OAAO,EAAP,OAFY;UAGZ,cAAc,EAAE;QAHJ,CAAd;QAKA,KAAK,QAAL,CAAc,GAAd,CAAkB,EAAlB;MACD,CAPD,MAOO;QACL,KAAK,IAAL,CAAU,EAAV,EAAc;UACZ,MAAM,EAAE,qBAAqB,CAAC,MADlB;UAEZ,OAAO,EAAP,OAFY;UAGZ,cAAc,EAAE;QAHJ,CAAd;MAKD;IACF;;;WAEM,iBAAQ,EAAR,EAAoB,QAApB,EAAyC;MAC9C,IAAI,KAAK,QAAL,CAAc,GAAd,CAAkB,EAAlB,CAAJ,EAA2B;QACzB,KAAK,IAAL,CAAU,EAAV,EAAc;UACZ,MAAM,EAAE,qBAAqB,CAAC,MADlB;UAEZ,OAAO,EAAE,IAFG;UAGZ,cAAc,EAAE;QAHJ,CAAd;QAKA,KAAK,QAAL,CAAc,MAAd,CAAqB,EAArB;MACD,CAPD,MAOO,IAAI,QAAJ,EAAc;QACnB,QAAQ;MACT;IACF;;;WAEM,qBACL,QADK,EACuD;MAE5D,KAAK,QAAL,GAAgB,QAAhB;MACA,KAAK,cAAL,CAAoB,OAApB,CAA4B,gBAAmB;QAAA,IAAhB,EAAgB,QAAhB,EAAgB;QAAA,IAAZ,MAAY,QAAZ,MAAY;QAC7C,QAAQ,CAAC,EAAD,EAAK,MAAL,CAAR;MACD,CAFD;IAGD;;;WAEO,cAAK,EAAL,EAAiB,MAAjB,EAA6C;MACnD,IAAI,KAAK,QAAT,EAAmB;QACjB,KAAK,QAAL,CAAc,EAAd,EAAkB,MAAlB;MACD,CAFD,MAEO;QACL,KAAK,cAAL,CAAoB,IAApB,CAAyB;UACvB,MAAM,EAAN,MADuB;UAEvB,EAAE,EAAF;QAFuB,CAAzB;MAID;IACF;;;;;;SA1DkB,c","sourceRoot":"","sourcesContent":["export var RootControllerChanges;\n(function (RootControllerChanges) {\n    RootControllerChanges[RootControllerChanges[\"Insert\"] = 0] = \"Insert\";\n    RootControllerChanges[RootControllerChanges[\"Update\"] = 1] = \"Update\";\n    RootControllerChanges[RootControllerChanges[\"Remove\"] = 2] = \"Remove\";\n})(RootControllerChanges || (RootControllerChanges = {}));\nexport default class RootController {\n    constructor() {\n        this.siblings = new Set();\n        this.pendingActions = [];\n        this.callback = null;\n    }\n    update(id, element, callback) {\n        if (!this.siblings.has(id)) {\n            this.emit(id, {\n                change: RootControllerChanges.Insert,\n                element,\n                updateCallback: callback\n            });\n            this.siblings.add(id);\n        }\n        else {\n            this.emit(id, {\n                change: RootControllerChanges.Update,\n                element,\n                updateCallback: callback\n            });\n        }\n    }\n    destroy(id, callback) {\n        if (this.siblings.has(id)) {\n            this.emit(id, {\n                change: RootControllerChanges.Remove,\n                element: null,\n                updateCallback: callback\n            });\n            this.siblings.delete(id);\n        }\n        else if (callback) {\n            callback();\n        }\n    }\n    setCallback(callback) {\n        this.callback = callback;\n        this.pendingActions.forEach(({ id, action }) => {\n            callback(id, action);\n        });\n    }\n    emit(id, action) {\n        if (this.callback) {\n            this.callback(id, action);\n        }\n        else {\n            this.pendingActions.push({\n                action,\n                id\n            });\n        }\n    }\n}\n//# sourceMappingURL=RootController.js.map"]},"metadata":{},"sourceType":"module"}